Very messy code but at least I know it's messy!
